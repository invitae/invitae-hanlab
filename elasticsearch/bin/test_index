#!/usr/bin/env bash
# Simple script to populate a 'test' index.
# Adds 100 test json files to a test index as background processes to simulate load.

. bin/set_port_env

for file in $(ls data/test-json)
do
  echo indexing $file
  echo curl -s -H "Content-Type: application/json" -XPUT localhost:$NODE_PORT/test/_doc/$file --data-binary @data/test-json/$file
  curl -s -H "Content-Type: application/json" -XPUT localhost:$NODE_PORT/test/_doc/$file --data-binary @data/test-json/$file &
done

# tests that the LTR plugin is able to be accessed
curl -s -H "Content-Type: application/json" -XPUT localhost:$NODE_PORT/_ltr/

# all requests should give non-error responses
